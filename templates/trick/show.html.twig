{% extends 'base.html.twig' %}

{% block title %}Hello Strick
{% endblock %}

{% block body %}
	<h1 id="trick" class="text-center my-5">{{ trick.name }}</h1>

	<div class="row">
		<div class="col-lg-12">
			<div
				class="card shadow-lg">
				{# <img src="{{trick.picture}}" class="card-img-top" alt="Mute"> #}
				{% if trick.pictures | length > 0 %}
					<img src="{{ asset('/uploads/' ~ trick.pictures[0].file) }}" class="card-img-top" alt="{{ trick.name}}">
				{% else %}
					<img src="http://via.placeholder.com/1600x900" class="card-img-top" alt="{{ trick.name}}">
				{% endif %}
				<div class="card-body">
					<h5 class="card-title">{{trick.name}}</h5>
					<small class="bg-light">Posté le
						{{ trick.createdAt | date('d/m/Y')}}
						-
						{{ (trick.updatedAt != null) ? 'Modifé le : ' ~ trick.updatedAt | date('d/m/Y à h:i') ~ ' - '}}
						<a href="{{ path('category_view', {'slug': trick.category.slug}) }}" class="badge bg-primary">{{ trick.category.title }}</a>
					</small>
					<div class="row mt-3">
						<div class="col-lg-6">
							<div id="carouselPicturesTricks" class="carousel slide" data-bs-ride="carousel">
								<div class="carousel-indicators">
									{% for picture in trick.pictures %}
										<button type="button" data-bs-target="#carouselPicturesTricks" data-bs-slide-to="{{ loop.index0 }}" {{ (loop.first) ? 'class="active" aria-current="true"' }} aria-label="Slide {{loop.index }}"></button>
									{% endfor %}
								</div>
								<div class="carousel-inner">
									{% for picture in trick.pictures %}
										<div class="carousel-item {{ (loop.first) ? 'active' }}">
											<img src="{{ asset('uploads/' ~ picture.file ) }}" class="d-block w-100" alt="image {{ trick.name }}">
										</div>
									{% endfor %}
								</div>
								<button class="carousel-control-prev" type="button" data-bs-target="#carouselPicturesTricks" data-bs-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Previous</span>
								</button>
								<button class="carousel-control-next" type="button" data-bs-target="#carouselPicturesTricks" data-bs-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Next</span>
								</button>
							</div>
						</div>

						<div class="col-lg-6">
							<div id="carouselVideoTricks" class="carousel slide" data-bs-ride="carousel">
								<div class="carousel-indicators">
									{% for video in trick.videos %}
										<button type="button" data-bs-target="#carouselVideoTricks" data-bs-slide-to="{{ loop.index0 }}" {{ (loop.first) ? 'class="active" aria-current="true"' }} aria-label="Slide {{loop.index }}"></button>
									{% endfor %}
								</div>
								<div class="carousel-inner">
									{% for video in trick.videos %}
										<div class="carousel-item {{ (loop.first) ? 'active' }} ratio ratio-16x9">
											<iframe src="{{ video.url }}" title="Video {{ trick.name }}" allowfullscreen></iframe>
										</div>
									{% endfor %}
								</div>
								<button class="carousel-control-prev" type="button" data-bs-target="#carouselVideoTricks" data-bs-slide="prev">
									<span class="carousel-control-prev-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Previous</span>
								</button>
								<button class="carousel-control-next" type="button" data-bs-target="#carouselVideoTricks" data-bs-slide="next">
									<span class="carousel-control-next-icon" aria-hidden="true"></span>
									<span class="visually-hidden">Next</span>
								</button>
							</div>
						</div>
					</div>
				
				{# <div class="row">
										{% for video in trick.videos %}
											<div class="col-lg-4 my-2">
												<div class="ratio ratio-16x9">
													<iframe src="{{ video.url }}" title="Video {{ trick.name }}" allowfullscreen></iframe>
												</div>
											</div>
										{% endfor %}
									</div> #}
				<p class="card-text">{{trick.description |  raw}}</p>
				<h4 class="text-end me-5">Auteur du trick
					<a href="{{ path('user_show', {'slug': trick.author.slug}) }}">{{trick.author.username}}</a>.</h4>
				{# {% if (app.user and app.user == trick.author) or is_granted('ROLE_ADMIN') %} #}
				{% if is_granted('edit', trick) %}
					<a href="{{ path('trick_edit', {'slug': trick.slug }) }}"><i class="fas fa-pencil-alt"></i></a>
					{{ include('trick/_delete_form.html.twig') }}
				{% endif %}
			</div>
		</div>
	</div>
{% endblock %}
